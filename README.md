# 1C Automation Tool — GUI Edition

Инструмент для работы с серверной средой **1С:Предприятие 8**. Взаимодействует с сервером, каталогом Active Directory, контролирует пользовательский ввод и выполняет операции через графический интерфейс.

**Версия:** 1.0.0.0  
**Автор:** t3hc0nnect10n © 2026

---

## Требования

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|   Требование   |                                                                                 Описание                                                                                                                                  |
|----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **WinRM**      |          Должна быть настроена служба Windows Remote Management для удалённого выполнения.<br>[Документация Microsoft](https://learn.microsoft.com/en-us/windows/win32/winrm/portal)                                         |
| **PowerShell** |          Политика выполнения должна разрешать запуск скриптов.<br>[Документация Microsoft](https://learn.microsoft.com/ru-ru/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-7.5) |
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

### Политика выполнения PowerShell

Перед первым запуском может потребоваться установить политику выполнения, например:

```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

При изменении политики для всей системы могут потребоваться права администратора.

---

## Запуск

```powershell
.\1C-Automation-Tool-GUI.ps1
```

1. Укажите имя или адрес сервера и нажмите **Подключиться**.
2. После успешного подключения станут доступны кнопки функций **1–9**.
3. Выберите нужную функцию и следуйте подсказкам в диалогах.

---

## Функции сценария

### Краткая таблица функций
---------------------------------------------------------------------------------------------------------------
| № | Функция                              | Назначение                                                       |
|---|--------------------------------------|------------------------------------------------------------------|
| 1 | Информация о COM-объекте             | Проверка регистрации V82/V83 COMConnector                        |
| 2 | Информация о версиях платформы       | Список установленных продуктов 1С                                |
| 3 | Информация о службе                  | Состояние служб 1С                                               |
| 4 | Работа со службой                    | Запуск, остановка, перезапуск службы                             |
| 5 | Работа с COM-объектом                | Регистрация / отмена регистрации COM                             |
| 6 | Удаление активных сессий             | Завершение сессий в выбранных базах или на всём кластере         |
| 7 | Удаление временных файлов            | Очистка временных файлов выбранной версии                        |
| 8 | Удаление сервера                     | Деинсталляция сервера и службы 1С                                |
| 9 | Установка сервера                    | Установка и настройка сервера и службы 1С                        |
---------------------------------------------------------------------------------------------------------------

### 1. Информация о COM-объекте

Проверяет наличие и версии COM-компонент **V82.COMConnector** и **V83.COMConnector** на сервере. 
<br>Результат выводится в окно сценария: зарегистрирована компонента или нет, при наличии — версия из реестра.

- Операция выполняется локально или удалённо в зависимости от выбранного сервера.

---

### 2. Информация о версиях платформы

Показывает установленные продукты **1С:Предприятие** и **1С:Enterprise** (название, версия, издатель, дата установки, путь). 
<br>Данные берутся из реестра Windows (в т.ч. ветка Wow6432Node для 32-разрядных установок).

- Если продукт не найден, выводится предупреждение.
- Операция выполняется локально или удалённо в зависимости от выбранного сервера.

---

### 3. Информация о службе

Выводит список служб Windows, имя которых начинается с **1C**, и их состояние (например, «Работает», «Остановлена»). 
<br>Позволяет быстро оценить, какие службы 1С установлены и запущены на сервере.

- Операция выполняется локально или удалённо в зависимости от выбранного сервера.

---

### 4. Работа со службой

Управление службой 1С: **запуск**, **остановка**, **перезапуск**.

- Сначала выбирается служба из списка (если их несколько).
- Затем выбирается действие: запуск, остановка или перезапуск.
- Операция выполняется локально или удалённо в зависимости от выбранного сервера.

---

### 5. Работа с COM-объектом

**Регистрация** или **отмена регистрации** COM-компонент 1С на сервере.

- Выбирается служба 1С (если их несколько).
- Выбирается действие: регистрация или отмена регистрации COM-объекта.
- Операция выполняется локально или удалённо в зависимости от выбранного сервера.

---

### 6. Удаление активных сессий

Завершение активных сессий пользователей в кластере 1С.

- Выбор компоненты: **V82.COMConnector** или **V83.COMConnector**.
- Ввод порта сервера (например, 1740).
- Два режима:
  - **Из выбранных баз** — ввод списка баз, формируется лог отключённых сессий.
  - **Все сессии на кластере** — отключение всех сессий, формируется лог.
- Операция выполняется локально или удалённо в зависимости от выбранного сервера.
 
Логи сохраняются в папку откуда запускался скрипт.

---

### 7. Удаление временных файлов

Удаление временных файлов 1С для выбранных версий платформы.

- Выбирается версия 1С из списка установленных.
- Сценарий находит и удаляет временные файлы, связанные с этой версией (в т.ч. кэш, временные каталоги). <br>Отображается прогресс и результат.
- Операция выполняется локально или удалённо в зависимости от выбранного сервера.

---

### 8. Удаление сервера и службы

Удаление сервера 1С:Предприятие и связанной службы с компьютера.

- Выбирается продукт из списка установленных (если их несколько).
- Выполняется деинсталляция выбранного продукта и службы. <br>Рекомендуется предварительно остановить службу и убедиться, что нет активных сессий.
- Операция выполняется локально или удалённо в зависимости от выбранного сервера.
---

### 9. Установка сервера и службы

Установка сервера 1С:Предприятие и настройка службы на целевом компьютере.

- Указывается **локальный путь к дистрибутиву** 1С (например, `C:\Distrib\1C\8.3.22.2239`).
- Выбирается **MSI-файл** установки из указанной папки.
- Ввод **учётной записи службы** (доменная) и пароля; проверка учётных данных в Active Directory.
- Выполняется установка и настройка службы:
  - порт сервера,
  - порт кластера,
  - диапазон портов рабочих процесов,
  - путь к папке временных процессов. 
- Операция выполняется локально или удалённо в зависимости от выбранного сервера.
---

## Примечания

- Для работы с **удалённым сервером** необходимо предварительно настроить WinRM на целевом компьютере и иметь права на выполнение команд.
- Проверка учётных данных домена выполняется через .NET (System.DirectoryServices), без модуля RSAT-AD-PowerShell.
- Логи и пути, используемые сценарием (например, для логов сессий), можно уточнить в коде `1C-Automation-Tool-GUI.ps1`.

---

## Рекомендация

Для удобства запуска сценарий можно собрать в один исполняемый файл (.exe) с помощью **Win-PS2EXE** (модуль PowerShell). 
<br>Тогда не потребуется открывать PowerShell и вызывать скрипт вручную — достаточно запустить exe двойным щелчком.

Установка модуля (если ещё не установлен):

```powershell
Install-Module -Name ps2exe -Scope CurrentUser
```

Пример сборки exe:

```powershell
Invoke-ps2exe -inputFile ".\1C-Automation-Tool-GUI.ps1" -outputFile ".\1C-Automation-Tool-GUI.exe"
```

При необходимости можно использовать опции: 

 - `-noConsole`    — запуск без окна консоли (только GUI), 
 - `-noError`      — не показывать окно с ошибками при падении скрипта, 
 - `-requireAdmin` — запрос прав администратора при запуске.
